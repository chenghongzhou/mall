webpackJsonp([9],{txAx:function(t,s){},xXi2:function(t,s){},yNo8:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=a("mvHQ"),i=a.n(e),o=(a("YtJ0"),a("P9l9")),n={data:function(){return{params:{},userInfoData:{},storeId:"",successMask:!1,openid:"",fileMask:!1,id:"",q_num:0,s_time:"",e_time:""}},methods:{buyGood:function(){1==this.params.source?this.getGood():this.$router.replace({path:"/buyGood?id="+this.id})},goTaskWall:function(){this.$router.replace({path:"/taskWall"})},getData:function(){var t=this,s=t.id;t.$loading.show();var a={store_id:t.storeId,open_id:t.openid,data:{productId:Number(s)}};t.$axios.post(o.a+"/items/get_item",a,{headers:{"Content-Type":"multipart/form-data"}}).then(function(s){s.data?(t.params=s.data,setTimeout(function(){t.detailBox()},0)):config.layerMsg(s.data.msg,2),t.$loading.close()}).catch(function(){t.$loading.close(),console.log("error")})},formatTime:function(t){var s=new Date(1e3*t);return s.getFullYear()+"."+(s.getMonth()+1<10?"0"+(s.getMonth()+1):s.getMonth()+1)+"."+(s.getDate()<10?"0"+s.getDate():s.getDate())},getQInfo:function(){var t=this;t.$axios.get("http://v8tob.youwoxing.net/store/product_library/pdd_detail?ids=156284673098&klk="+t.params.goods_id).then(function(s){s.data?(t.q_num=s.data.coupon_remain_quantity,t.s_time=t.formatTime(s.data.coupon_start_time),t.e_time=t.formatTime(s.data.coupon_end_time)):config.layerMsg("出错了~",2)}).catch(function(){console.log("error")})},getGood:function(){this.openid;var t=this.params.score;if(this.userInfoData.score<t)return this.fileMask=!1,!1;this.q_num>0?this.handleEx():config.layerMsg("库存不足~",2)},handleSuccessMask:function(){window.location.href=this.params.pdd_url},handleEx:function(){var t=this,s={store_id:t.storeId,open_id:t.openid,data:{score:t.params.cost||0,useType:t.params.goods_id,num:1,pay_money:0,address:"",name:"",tel:"",product_id:t.params.id,pay_type:0}};t.$axios.post(o.a+"/items/give_item",s,{headers:{"Content-Type":"multipart/form-data"}}).then(function(s){200==s.data.code?(t.getUserInfoMy(),t.successMask=!0):201==s.data.code?t.fileMask=!0:config.layerMsg("出错了~",2)}).catch(function(){console.log("error")})},detailBox:function(){var t=this.$refs.detailBox,s=t.getElementsByTagName("img");if(s.length>0)for(var a=0;a<s.length;a++)s[a].style.width="100%"},getUserInfoMy:function(){var t=this,s={open_id:t.openid,store_id:t.storeId,data:{avatar_url:t.userInfoData.headimgurl,nick_name:t.userInfoData.nickname}};t.$axios.post(o.a+"/c_account/get_user_info",s,{headers:{"Content-Type":"multipart/form-data"}}).then(function(s){0==s.data.error_code?(t.userInfoData=s.data.user_data,config.setCookie("userInfoData",i()(t.userInfoData),7)):config.layerMsg(s.data.msg,2)}).catch(function(){console.log("error")})},getf:function(){var t=config.getCookie("userInfoData");this.id=config.getHashVReq("id"),t&&(this.userInfoData=JSON.parse(t));var s=config.getCookie("userInfo");s&&(this.storeId=Number(JSON.parse(s).storeId));var a=config.getCookie("openid");a&&(this.openid=JSON.parse(a).open_id)},forbidBack:function(){this.$router.replace({path:"/"})}},destroyed:function(){window.removeEventListener("popstate",this.forbidBack,!1)},activated:function(){var t=this;this.getf(),window.scrollTo(0,0),this.$store.state.goodInfo.id?(this.params=this.$store.state.goodInfo,setTimeout(function(){t.detailBox()},0)):this.getData(),this.getQInfo()},mounted:function(){var t=this;this.getf(),window.scrollTo(0,0),this.$store.state.goodInfo.id?(this.params=this.$store.state.goodInfo,setTimeout(function(){t.detailBox()},0)):this.getData(),this.getQInfo(),config.isGoBack(this.forbidBack),this.$nextTick(function(){})}},r={render:function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"main"},[a("div",{staticClass:"top",staticStyle:{position:"fixed",top:"0px",left:"0px","z-index":"10",height:"1.04rem"}},[a("i",{staticClass:"top_close",on:{click:function(s){return t.forbidBack()}}}),t._v("\n            商品详情\n        ")]),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticStyle:{height:"1.04rem",width:"100%"}}),t._v(" "),a("div",{staticClass:"header"},[a("img",{attrs:{src:t.params.pic,alt:""}})]),t._v(" "),a("div",{staticClass:"good_info_box",class:{good_info_box_self:0==t.params.source}},[a("div",{staticStyle:{overflow:"hidden",position:"relative"}},[a("div",{staticClass:"good_price_part"},[0==t.params.source?a("div",{staticClass:"price",staticStyle:{"margin-top":"0.35rem"}}):t._e(),t._v(" "),0==t.params.source?a("div",{staticClass:"price_result",class:{good_source:1==t.params.source}},[0==t.params.buy_type?a("div",[a("span",[t._v(t._s(t.params.current_price)+"元")])]):t._e(),t._v(" "),1==t.params.buy_type?a("div",[a("i"),a("span",[t._v(t._s(t.params.cost))]),t._v("积分\n                            ")]):t._e(),t._v(" "),2==t.params.buy_type?a("div",[a("i"),a("span",[t._v(t._s(t.params.cost))]),t._v("积分 "),0==t.params.source?a("span",[t._v("+"+t._s(t.params.current_price)+"元")]):t._e()]):t._e()]):t._e(),t._v(" "),1==t.params.source?a("div",{staticClass:"price_result",class:{good_source:1==t.params.source}},[a("i",{staticStyle:{background:"url('../../../../static/images/goodDetail/q_icon.png') center no-repeat","background-size":"contain"}}),a("span",[t._v(t._s((t.params.coupon_discount/100).toFixed(2))+"抵用券")])]):t._e(),t._v(" "),1==t.params.source?a("div",{staticClass:"q_time"},[t._v(t._s(t.s_time)+"-"+t._s(t.e_time))]):t._e()]),t._v(" "),a("div",{staticClass:"ex_people_nums"},[a("div",[t._v(t._s(t.params.cost)+"积分")])])]),t._v(" "),a("div",{staticClass:"good_info_tl",class:{good_info_tl_self:0==t.params.source}},[a("div",{staticClass:"good_name"},[t._v(t._s(t.params.name))]),t._v(" "),1==t.params.source?a("div",{staticClass:"p_q"},[a("span",[t._v("￥")]),t._v(t._s((t.params.current_price/100).toFixed(2))),a("span",[t._v("券后价")]),a("font",[t._v("￥"+t._s((t.params.normal_price/100).toFixed(2)))])],1):t._e()])]),t._v(" "),1==t.params.source?a("div",{staticClass:"exchange_info"},[a("p",[t._v("兑换说明")]),t._v(" "),a("ul",[a("li",[a("span"),t._v("兑换成功后，可获得 "+t._s((t.params.coupon_discount/100).toFixed(2))+" 元抵扣价。")]),t._v(" "),a("li",[a("span"),t._v("券后仅需 "+t._s((t.params.current_price/100).toFixed(2))+" 元即可购买，以购买页实时价格为准。")]),t._v(" "),t._m(0)])]):t._e(),t._v(" "),a("div",{ref:"detailBox",staticClass:"good_detail",domProps:{innerHTML:t._s(t.params.dec)}}),t._v(" "),a("div",{staticClass:"good_detail_footer"},[a("div",{staticClass:"btn",on:{click:function(s){return t.buyGood()}}},[t._v("立即兑换")])])]),t._v(" "),t.successMask?a("div",{staticClass:"mask"},[a("div",{staticClass:"mask_main success"},[a("div",{staticClass:"box tanchuscale"},[a("div",{staticClass:"success_title"},[t._v("兑换成功")]),t._v(" "),a("div",{staticClass:"success_msg"},[t._v("继续赚取积分，兑换更多好礼")]),t._v(" "),a("div",{staticClass:"success_btn",on:{click:function(s){return t.handleSuccessMask()}}},[t._v("立即查看")])])])]):t._e(),t._v(" "),t.fileMask?a("div",{staticClass:"mask"},[a("div",{staticClass:"mask_main file"},[a("div",{staticClass:"box tanchuscale"},[a("div",{staticClass:"file_title"},[t._v("积分不足")]),t._v(" "),a("div",{staticClass:"file_need"},[t._v("本次兑换共需"+t._s(t.params.cost||0)+"积分")]),t._v(" "),a("div",{staticClass:"file_you"},[t._v("当前积分"+t._s(t.userInfoData.score))]),t._v(" "),a("div",{staticClass:"file_btn",on:{click:function(s){return t.goTaskWall()}}},[t._v("立即赚积分")]),t._v(" "),a("div",{staticClass:"file_close",on:{click:function(s){t.fileMask=!1}}})])])]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("span"),this._v("请在适用范围内适用，数量有限，兑完即止。")])}]};var c=a("VU/8")(n,r,!1,function(t){a("txAx"),a("xXi2")},"data-v-3a3b85d4",null);s.default=c.exports}});