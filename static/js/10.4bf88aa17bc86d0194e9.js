webpackJsonp([10],{YKGn:function(t,s){},tmcv:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});e("YtJ0");var o=e("P9l9"),a={data:function(){return{num:1,successMask:!1,fileMask:!1,goodInfo:{},total_integral:"",total_price:"",userInfoData:{},list:[],defaultDate:{name:"",tel:"",address_detail:"",address:""},storeId:"",openid:"",wx_code:!1,goodImg:"",goodText:"",id:"",kserver:!1,kserverCode:"",sh_server:!1,shServerCode:""}},methods:{goodNum:function(t){1==t?this.num>1?this.num=this.num-1:this.num=1:this.num++,this.total_integral=this.goodInfo.cost*this.num,this.total_price=this.goodInfo.current_price*this.num},goGoodRecord:function(){this.sh_server=!1,this.kserver=!1,this.$router.replace({path:"/exchangeRecord"})},handleSuccessMask:function(){0==this.goodInfo.show_type?""!=this.goodInfo.exchange_jump_url?(this.successMask=!1,window.location.href=this.goodInfo.exchange_jump_url):config.layerMsg("未配置链接！",2):1==this.goodInfo.show_type?(this.goodImg=this.goodInfo.exchange_show_pic,this.goodText=this.goodInfo.exchange_show_text,this.successMask=!1,this.wx_code=!0):2==this.goodInfo.show_type?(this.successMask=!1,1==this.goodInfo.is_need_qrcode?(this.shServerCode=this.goodInfo.qrcode,this.sh_server=!0):this.$router.replace({path:"/exchangeRecord"})):config.layerMsg("类型错误",2)},handleServer:function(){this.wx_code=!1,1==this.goodInfo.is_need_qrcode?(this.kserverCode=this.goodInfo.qrcode,this.kserver=!0):this.$router.replace({path:"/exchangeRecord"})},getGood:function(){var t=this;if(2==t.goodInfo.show_type&&!t.defaultDate.name)return config.layerMsg("请添加收获地址~",2),!1;var s={store_id:t.storeId,open_id:t.openid,data:{score:t.goodInfo.cost||0,useType:t.goodInfo.goods_id,num:1,pay_money:t.goodInfo.current_price,address:"",name:"",tel:"",product_id:t.goodInfo.id,pay_type:1}};2==t.goodInfo.show_type&&(s.data.address=t.defaultDate.address+t.defaultDate.address_detail,s.data.name=t.defaultDate.name,s.data.tel=t.defaultDate.tel),0==t.goodInfo.buy_type&&(s.data.pay_type=2);t.$axios.post(o.a+"/items/give_item",s,{headers:{"Content-Type":"multipart/form-data"}}).then(function(s){200==s.data.code?t.successMask=!0:201==s.data.code?t.fileMask=!0:config.layerMsg("出错了~",2)}).catch(function(){console.log("error")})},getData:function(){var t=this,s=t.id;t.$loading.show();var e={store_id:t.storeId,open_id:t.openid,data:{productId:Number(s)}};t.$axios.post(o.a+"/items/get_item",e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(s){s.data?(t.goodInfo=s.data,t.total_integral=t.goodInfo.cost,t.total_price=t.goodInfo.current_price):config.layerMsg(s.data.msg,2),t.$loading.close()}).catch(function(){t.$loading.close(),console.log("error")})},handleEx:function(){var t={store_id:this.storeId,open_id:this.openid,data:{score:this.goodInfo.is_give_integral,useType:this.goodInfo.goods_id,count:this.num}};this.$axios.post(o.a+"/c_account/use_score",t,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){t.data||config.layerMsg("出错了~",2)}).catch(function(){console.log("error")})},getAddress:function(){var t=this,s={store_id:t.storeId,open_id:t.openid};t.$axios.post(o.a+"/c_account/get_user_contacts",s,{headers:{"Content-Type":"multipart/form-data"}}).then(function(s){s.data?(t.list=s.data,t.list.length>0&&(t.list.forEach(function(s,e){s.if_default&&(t.defaultDate=s)}),t.defaultDate.if_default||(t.defaultDate=t.list[0]))):config.layerMsg("出错了~",2)}).catch(function(){console.log("error")})},goAddress:function(){this.$router.replace({path:"/addressManagement/index"})},goTaskWall:function(){this.$router.replace({path:"/taskWall"})},forbidBack:function(){this.$router.replace({path:"/goodDetail?id="+this.id})},getf:function(){var t=config.getCookie("userInfoData");this.id=config.getHashVReq("id"),t&&(this.userInfoData=JSON.parse(t));var s=config.getCookie("userInfo");s&&(this.storeId=Number(JSON.parse(s).storeId));var e=config.getCookie("openid");e&&(this.openid=JSON.parse(e).open_id),this.defaultDate.name=config.getHashVReq("name"),this.defaultDate.tel=config.getHashVReq("tel"),this.defaultDate.address=config.getHashVReq("address"),this.defaultDate.address_detail=config.getHashVReq("address_detail")}},destroyed:function(){window.removeEventListener("popstate",this.forbidBack,!1)},activated:function(){this.getf(),this.$store.state.goodInfo.id?(this.goodInfo=this.$store.state.goodInfo,this.total_integral=this.goodInfo.cost,this.total_price=this.goodInfo.current_price):this.getData()},mounted:function(){config.isGoBack(this.forbidBack),this.getf(),this.$store.state.goodInfo.id?(this.goodInfo=this.$store.state.goodInfo,this.total_integral=this.goodInfo.cost,this.total_price=this.goodInfo.current_price):this.getData(),this.$nextTick(function(){})}},i={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"main"},[e("div",{staticClass:"top"},[e("i",{staticClass:"top_close",on:{click:function(s){return t.forbidBack()}}}),t._v("\n            确认兑换\n        ")]),t._v(" "),0==t.goodInfo.source&&2==t.goodInfo.show_type?e("div",{staticClass:"address_box",on:{click:function(s){return t.goAddress()}}},[t.defaultDate.name?e("div",{staticClass:"address_icon"}):t._e(),t._v(" "),t.defaultDate.name?e("div",{staticClass:"address_info"},[e("div",{staticClass:"address_info_name"},[t._v(t._s(t.defaultDate.name)+"  "+t._s(t.defaultDate.tel))]),t._v(" "),e("div",{staticClass:"address_info_address"},[t._v(t._s(t.defaultDate.address)+" "+t._s(t.defaultDate.address_detail))])]):t._e(),t._v(" "),t.defaultDate.name?t._e():e("div",{staticClass:"address_info"},[e("div",{staticClass:"address_info_name",staticStyle:{"margin-top":"0.4rem",color:"#cccccc"}},[t._v(" 请选择收货地址")])]),t._v(" "),e("div",{staticClass:"address_list"}),t._v(" "),e("div",{staticClass:"go_edit_address"})]):t._e(),t._v(" "),e("div",{staticClass:"buy_good_box"},[e("div",{staticClass:"order_info_box"},[e("img",{staticClass:"order_good_img",attrs:{src:t.goodInfo.pic,alt:""}}),t._v(" "),e("div",{staticClass:"order_info"},[e("div",{staticClass:"order_name"},[t._v(t._s(t.goodInfo.name))]),t._v(" "),e("div",{staticClass:"good_intr"},[t._v(t._s(t.goodInfo.name_dec))]),t._v(" "),e("div",{staticClass:"good_price"},[0==t.goodInfo.buy_type?e("div",[e("span",[t._v("￥"+t._s(t.goodInfo.current_price))])]):t._e(),t._v(" "),1==t.goodInfo.buy_type?e("div",[e("i",{staticClass:"money_icon"}),t._v(t._s(t.goodInfo.cost)+"\n                        ")]):t._e(),t._v(" "),2==t.goodInfo.buy_type?e("div",[e("i",{staticClass:"money_icon"}),t._v(t._s(t.goodInfo.cost)),0==t.goodInfo.source?e("span",[t._v("+￥"+t._s(t.goodInfo.current_price))]):t._e()]):t._e()])])])]),t._v(" "),e("div",{staticClass:"footer"},[e("div",{staticClass:"money_box"},[1==t.goodInfo.buy_type||2==t.goodInfo.buy_type?e("div",{staticClass:"intergral",class:{is_jf:1==t.goodInfo.buy_type}},[t._v("合计(积分)："),e("i"),e("span",[t._v(t._s(t.total_integral))])]):t._e(),t._v(" "),0==t.goodInfo.buy_type||2==t.goodInfo.buy_type?e("div",{staticClass:"money"},[t._v("合计(现金)："),e("i"),e("font",[t._v("￥")]),e("span",[t._v(t._s(t.total_price))])],1):t._e()]),t._v(" "),e("div",{staticClass:"btn",on:{click:function(s){return t.getGood()}}},[t._v("立即兑换")])]),t._v(" "),t.successMask?e("div",{staticClass:"mask"},[e("div",{staticClass:"mask_main success"},[e("div",{staticClass:"box tanchuscale"},[e("div",{staticClass:"success_title"},[t._v("兑换成功")]),t._v(" "),e("div",{staticClass:"success_msg"},[t._v("继续赚取积分，兑换更多好礼")]),t._v(" "),e("div",{staticClass:"success_btn",on:{click:function(s){return t.handleSuccessMask()}}},[t._v("立即查看")]),t._v(" "),e("div",{staticClass:"file_close",on:{click:function(s){t.successMask=!1}}})])])]):t._e(),t._v(" "),t.fileMask?e("div",{staticClass:"mask"},[e("div",{staticClass:"mask_main file"},[e("div",{staticClass:"box tanchuscale"},[e("div",{staticClass:"file_title"},[t._v("积分不足")]),t._v(" "),e("div",{staticClass:"file_need"},[t._v("本次兑换共需"+t._s(t.goodInfo.cost||0)+"积分")]),t._v(" "),e("div",{staticClass:"file_you"},[t._v("当前积分"+t._s(t.userInfoData.score))]),t._v(" "),e("div",{staticClass:"file_btn",on:{click:function(s){return t.goTaskWall()}}},[t._v("立即赚积分")]),t._v(" "),e("div",{staticClass:"file_close",on:{click:function(s){t.fileMask=!1}}})])])]):t._e(),t._v(" "),t.wx_code?e("div",{staticClass:"mask"},[e("div",{staticClass:"mask_main_good"},[e("div",{staticClass:"box tanchuscale"},[e("img",{staticClass:"mask_wx_code",attrs:{src:t.goodImg,alt:""}}),t._v(" "),e("div",{staticClass:"exchange_show_text"},[t._v(t._s(t.goodText))]),t._v(" "),e("div",{staticClass:"success_btn",staticStyle:{"margin-top":"0.1rem"},on:{click:function(s){return t.handleServer()}}},[t._v("确定")]),t._v(" "),e("div",{staticClass:"file_close",on:{click:function(s){t.wx_code=!1}}})])])]):t._e(),t._v(" "),t.kserver?e("div",{staticClass:"mask"},[e("div",{staticClass:"mask_main_good"},[e("div",{staticClass:"box tanchuscale"},[e("img",{staticClass:"mask_wx_code",attrs:{src:t.kserverCode,alt:""}}),t._v(" "),e("div",{staticClass:"success_btn",staticStyle:{"margin-top":"0.4rem"},on:{click:function(s){return t.goGoodRecord()}}},[t._v("我已添加客服")])])])]):t._e(),t._v(" "),t.sh_server?e("div",{staticClass:"mask"},[e("div",{staticClass:"mask_main_good"},[e("div",{staticClass:"box tanchuscale"},[e("img",{staticClass:"mask_wx_code",attrs:{src:t.shServerCode,alt:""}}),t._v(" "),e("div",{staticClass:"success_btn",staticStyle:{"margin-top":"0.4rem"},on:{click:function(s){return t.goGoodRecord()}}},[t._v("我已添加客服")])])])]):t._e()])},staticRenderFns:[]};var n=e("VU/8")(a,i,!1,function(t){e("YKGn")},"data-v-917c5ae4",null);s.default=n.exports}});